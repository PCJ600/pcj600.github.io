<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="VLyEpKy1Jq3gcpFmB3W8Ql0f4f-G35UyYi1NJ8Towq0">
  <meta name="baidu-site-verification" content="codeva-dRzuqywF6U">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"pcj600.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":true,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="前言不错的Python进阶书。写这个笔记的目的是，把书中提到的编写高质量Python的59个方法的要点记录下来，便于今后的工作中查阅 第1章：用Pythonic方式来思考">
<meta property="og:type" content="article">
<meta property="og:title" content="Effective Python 笔记">
<meta property="og:url" content="https://pcj600.github.io/2023/0812215151.html">
<meta property="og:site_name" content="PC&#39;s Blog">
<meta property="og:description" content="前言不错的Python进阶书。写这个笔记的目的是，把书中提到的编写高质量Python的59个方法的要点记录下来，便于今后的工作中查阅 第1章：用Pythonic方式来思考">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-08-12T13:51:51.000Z">
<meta property="article:modified_time" content="2024-08-18T13:52:41.572Z">
<meta property="article:author" content="PC">
<meta property="article:tag" content="Python">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://pcj600.github.io/2023/0812215151.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Effective Python 笔记 | PC's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">PC's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Life is short, Play more!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">32</span></a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">41</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">139</span></a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://pcj600.github.io/2023/0812215151.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="PC">
      <meta itemprop="description" content="PC的博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="PC's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Effective Python 笔记
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-08-12 21:51:51" itemprop="dateCreated datePublished" datetime="2023-08-12T21:51:51+08:00">2023-08-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>13k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>12 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>不错的Python进阶书。写这个笔记的目的是，把书中提到的编写高质量Python的59个方法的要点记录下来，便于今后的工作中查阅</p>
<h1 id="第1章：用Pythonic方式来思考"><a href="#第1章：用Pythonic方式来思考" class="headerlink" title="第1章：用Pythonic方式来思考"></a>第1章：用Pythonic方式来思考</h1><span id="more"></span>

<h2 id="x20-1-用Pythonic方式来思考"><a href="#x20-1-用Pythonic方式来思考" class="headerlink" title="&#x20;1. 用Pythonic方式来思考"></a>&#x20;1. 用Pythonic方式来思考</h2><p>python之禅 —— <code>import this</code></p>
<h2 id="x20-2-遵循PEP8风格"><a href="#x20-2-遵循PEP8风格" class="headerlink" title="&#x20;2. 遵循PEP8风格"></a>&#x20;2. 遵循PEP8风格</h2><p>PEP8 —— Python Enhancement Proposal #8</p>
<p>空白：</p>
<ul>
<li>使用空格而不是tab表示缩进</li>
<li>和语法相关每一层缩进用4个空格</li>
<li>每行字符数不超过79</li>
<li>占据多行表达式，除首行外其余各行应在通常缩进级别上加4空格</li>
<li>函数与类之间两个空行隔开</li>
<li>同一个类中，各方法一个空行隔开</li>
<li>使用下标获取元素，不要在两旁加空格</li>
<li>为变量赋值，赋值符号左侧和右侧各自写一个空格，不要在两旁添加空格</li>
</ul>
<p>命名：</p>
<ul>
<li>函数、变量、属性用小写，各单词以下划线连接</li>
<li>受保护实例属性，以单下划线开头</li>
<li>私有实例属性：以两个下划线开头</li>
<li>类以异常，应每个单词以大写形式命名，如CapitalizedWord</li>
<li>模块级别常量，应全部采用大写，各单词以下划线相连，如ALL_CAPS</li>
<li>类中实例方法，应该把首个参数命名为self，以表示对象自身</li>
<li>类方法首个参数，应该命名为cls，以表示类自身</li>
</ul>
<p>表达式和语句：</p>
<ul>
<li>采用内联形式否定词，而不是把否定词放在整个表达式前面，例如写if a is not b 而不是 if not a is b</li>
<li>不要通过测长度方法判断list是否为空，应采用if not list，空值会自动评估为False</li>
<li>import语句总应放在文件开头</li>
<li>引入模块时总应使用绝对名称，不应根据当前模块路径使用相对名称，例如引入bar包中的foo模块，应完整写出from bar import foo，不应该简写import foo</li>
<li>文件中import语句应按顺序划三部分，分别表示标准库模块，第三方模块，自用模块，各部分中的import语句应按模块的字母顺序排列</li>
</ul>
<h2 id="3-了解bytes-str-unicode区别"><a href="#3-了解bytes-str-unicode区别" class="headerlink" title="3. 了解bytes, str, unicode区别"></a>3. 了解bytes, str, unicode区别</h2><ul>
<li>Python3中，bytes是一个包含8位置的序列，str是一种包含unicode字符序列</li>
</ul>
<h2 id="4-用辅助函数取代复杂表达式"><a href="#4-用辅助函数取代复杂表达式" class="headerlink" title="4. 用辅助函数取代复杂表达式"></a>4. 用辅助函数取代复杂表达式</h2><p>开发者容易过度运用Python语法特性，写出特别复杂难以理解的单行表达式。<strong>这种情况需要把复杂表达式移到辅助函数</strong></p>
<h2 id="5-了解切割序列的方法"><a href="#5-了解切割序列的方法" class="headerlink" title="5. 了解切割序列的方法"></a>5. 了解切割序列的方法</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;f&#x27;</span>,<span class="string">&#x27;g&#x27;</span>,<span class="string">&#x27;h&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a[:<span class="number">4</span>]</span><br><span class="line">[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a[<span class="number">5</span>:]</span><br><span class="line">[<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;h&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a[-<span class="number">2</span>:]</span><br><span class="line">[<span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;h&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a[<span class="number">2</span>:-<span class="number">3</span>]</span><br><span class="line">[<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a[:]</span><br><span class="line">[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;h&#x27;</span>]</span><br><span class="line">a[<span class="number">2</span>:<span class="number">6</span>] = [<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;o&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;h&#x27;</span>]</span><br></pre></td></tr></table></figure>

<h2 id="6-单次切片操作内，不要同时指定start-end-stride"><a href="#6-单次切片操作内，不要同时指定start-end-stride" class="headerlink" title="6. 单次切片操作内，不要同时指定start, end, stride"></a>6. 单次切片操作内，不要同时指定start, end, stride</h2><p>除了基本切片操作，Python还提供了somelist[start:end:stride]形式写法，以实现步进式切割，就是从每n个元素里取1个出来</p>
<p>既有start, end，又有stride的切割操作，可能令人费解，考虑拆解两条语句，其中一条做范围切割，另一条做步进切割，如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">b = a[::<span class="number">2</span>]    <span class="comment"># [&#x27;a&#x27;, &#x27;c&#x27;, &#x27;e&#x27;, &#x27;g&#x27;]</span></span><br><span class="line">c = b[<span class="number">1</span>:-<span class="number">1</span>]   <span class="comment"># [&#x27;c&#x27;, &#x27;e&#x27;]</span></span><br></pre></td></tr></table></figure>

<h2 id="x20-7-用列表推导取代map-filter"><a href="#x20-7-用列表推导取代map-filter" class="headerlink" title="&#x20;7. 用列表推导取代map, filter"></a>&#x20;7. 用列表推导取代map, filter</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">squares = [ x**<span class="number">2</span> <span class="keyword">for</span> x <span class="keyword">in</span> a ]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(squares)</span><br><span class="line">[<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>]</span><br><span class="line">或者<span class="built_in">map</span>, <span class="built_in">filter</span></span><br><span class="line">squares = <span class="built_in">map</span>(<span class="keyword">lambda</span> x: x ** <span class="number">2</span>, a)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">list</span>(squares)</span><br><span class="line">[<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>]</span><br></pre></td></tr></table></figure>

<h2 id="8-不要使用含有两个以上表达式的列表推导"><a href="#8-不要使用含有两个以上表达式的列表推导" class="headerlink" title="8. 不要使用含有两个以上表达式的列表推导"></a>8. 不要使用含有两个以上表达式的列表推导</h2><p>例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">my_lists = [</span><br><span class="line">    [[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]],</span><br><span class="line">]</span><br><span class="line">flat = [x <span class="keyword">for</span> sublist1 <span class="keyword">in</span> my_lists</span><br><span class="line">		  <span class="keyword">for</span> sublist2 <span class="keyword">in</span> sublist1</span><br><span class="line">		  <span class="keyword">for</span> x <span class="keyword">in</span> sublist2]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以看出，列表推导写法不够简洁，改用普通循环语句实现相同效果</span></span><br><span class="line">flat = []</span><br><span class="line"><span class="keyword">for</span> sublist1 <span class="keyword">in</span> my_lists:</span><br><span class="line">	<span class="keyword">for</span> sublist2 <span class="keyword">in</span> sublist1:</span><br><span class="line">		flat.extend(sublist2)</span><br></pre></td></tr></table></figure>

<h2 id="9-用生成器表达式改写数据量较大的列表推导"><a href="#9-用生成器表达式改写数据量较大的列表推导" class="headerlink" title="9. 用生成器表达式改写数据量较大的列表推导"></a>9. 用生成器表达式改写数据量较大的列表推导</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">it = (<span class="built_in">len</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&#x27;file.txt&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(it)</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">generator obj at XXX</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">next</span>(it))</span><br></pre></td></tr></table></figure>

<h2 id="10-尽量用enumerate取代range"><a href="#10-尽量用enumerate取代range" class="headerlink" title="10. 尽量用enumerate取代range"></a>10. 尽量用enumerate取代range</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flavor_list = [<span class="string">&#x27;vanilla&#x27;</span>, <span class="string">&#x27;chocolate&#x27;</span>, <span class="string">&#x27;pecan&#x27;</span>, <span class="string">&#x27;strawberry&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i, flavor <span class="keyword">in</span> <span class="built_in">enumerate</span>(flavor_list):</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;%d: %s&#x27;</span> % (i + <span class="number">1</span>, flavor))</span><br></pre></td></tr></table></figure>

<p>还可以直接指定enumerate函数开始计数时所用值，这样能把代码写的更短</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i, flavor <span class="keyword">in</span> <span class="built_in">enumerate</span>(flavor_list, <span class="number">1</span>):</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;%d: %s&#x27;</span> % (i, flavor))</span><br></pre></td></tr></table></figure>

<h2 id="11-用zip函数同时遍历两个迭代器"><a href="#11-用zip函数同时遍历两个迭代器" class="headerlink" title="11. 用zip函数同时遍历两个迭代器"></a>11. 用zip函数同时遍历两个迭代器</h2><p>使用range或enumerate方法的代码不够简洁</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">names = [<span class="string">&#x27;Cecilia&#x27;</span>, <span class="string">&#x27;Lise&#x27;</span>, <span class="string">&#x27;Marie&#x27;</span>]</span><br><span class="line">letters = [ <span class="built_in">len</span>(s) <span class="keyword">for</span> s <span class="keyword">in</span> names]</span><br><span class="line"></span><br><span class="line">longest_name = <span class="literal">None</span></span><br><span class="line">max_letters = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i, name <span class="keyword">in</span> <span class="built_in">enumerate</span>(names):</span><br><span class="line">    <span class="keyword">if</span> letters[i] &gt; max_letters:</span><br><span class="line">        max_letters = letters[i]</span><br><span class="line">        longest_name = name</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;longest_name: &#x27;</span>, longest_name)</span><br></pre></td></tr></table></figure>

<p>改用内置zip方法，使代码更清晰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">names = [<span class="string">&#x27;Cecilia&#x27;</span>, <span class="string">&#x27;Lise&#x27;</span>, <span class="string">&#x27;Marie&#x27;</span>]</span><br><span class="line">letters = [ <span class="built_in">len</span>(s) <span class="keyword">for</span> s <span class="keyword">in</span> names]</span><br><span class="line"></span><br><span class="line">longest_name = <span class="literal">None</span></span><br><span class="line">max_letters = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> name, count <span class="keyword">in</span> <span class="built_in">zip</span>(names, letters):</span><br><span class="line">    <span class="keyword">if</span> count &gt; max_letters:</span><br><span class="line">        longest_name = name</span><br><span class="line">        max_letters = count</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;longest_name: &#x27;</span>, longest_name)</span><br></pre></td></tr></table></figure>

<p>注意点：</p>
<ul>
<li>Python2中zip不是生成器，而是会把开发者提供那些迭代器都平行遍历一次，可能占用大量内存导致程序崩溃</li>
<li>如果输入迭代器长度不同，zip会提前终止，将导致意外结果</li>
</ul>
<h2 id="12-不要在for和while循环后写else块"><a href="#12-不要在for和while循环后写else块" class="headerlink" title="12. 不要在for和while循环后写else块"></a>12. 不要在for和while循环后写else块</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;Loop %d&#x27;</span> % i)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;Else block!&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>else块会在整个循环执行完之后立刻运行</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Loop %d&#x27;</span> % i)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Else block!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">$ python test.py</span><br><span class="line">Loop <span class="number">0</span></span><br><span class="line">Loop <span class="number">1</span></span><br><span class="line">Loop <span class="number">2</span></span><br><span class="line">Else block!</span><br></pre></td></tr></table></figure>

<ul>
<li>循环里用break提前跳出，会导致else块不执行</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;Loop %d&#x27;</span> % i)</span><br><span class="line">	<span class="keyword">if</span> i == <span class="number">1</span>:</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;Else block!&#x27;</span>)</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">Loop <span class="number">0</span></span><br><span class="line">Loop <span class="number">1</span></span><br></pre></td></tr></table></figure>

<ul>
<li>如果for循环遍历序列是空的，就会立刻执行else块</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> []:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;Never runs&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;For Else block!&#x27;</span>)</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">For Else block!</span><br></pre></td></tr></table></figure>

<p>要点：不要在循环后使用else块，这种写法即不直观，又容易让人误解</p>
<h2 id="13-合理利用try-except-else-finally结构中每个代码块"><a href="#13-合理利用try-except-else-finally结构中每个代码块" class="headerlink" title="13. 合理利用try&#x2F;except&#x2F;else&#x2F;finally结构中每个代码块"></a>13. 合理利用try&#x2F;except&#x2F;else&#x2F;finally结构中每个代码块</h2><ul>
<li>无论try是否异常，都可利用try&#x2F;finally复合语句中finally块执行清理工作</li>
<li>else块可用来缩减try代码量，并把没有发生异常所要执行的语句与try&#x2F;except分开</li>
<li>顺利运行try块后，若想使某些操作能在finaly块的清理代码前执行，可将这些操作写到else</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">UNDEFINED = <span class="built_in">object</span>()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">divide_json</span>(<span class="params">path</span>):</span><br><span class="line">	handle = <span class="built_in">open</span>(path, <span class="string">&#x27;r+&#x27;</span>)</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		data = handle.read()</span><br><span class="line">		op = json.loads(data)</span><br><span class="line">		value = (op[<span class="string">&#x27;numerator&#x27;</span>]/op[<span class="string">&#x27;denominator&#x27;</span>])</span><br><span class="line">	<span class="keyword">except</span> ZeroDivisionError es e:</span><br><span class="line">		<span class="keyword">return</span> UNDEFINED</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">	    op[<span class="string">&#x27;result&#x27;</span>] = value</span><br><span class="line">	    result = json.dumps(op)</span><br><span class="line">	    handle.seek(<span class="number">0</span>)</span><br><span class="line">	    handle.write(result)</span><br><span class="line">	    <span class="keyword">return</span> value</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">	    handle.close()</span><br></pre></td></tr></table></figure>

<h1 id="第2章-函数"><a href="#第2章-函数" class="headerlink" title="第2章 函数"></a>第2章 函数</h1><h2 id="14-尽量用异常来表示特殊情况，而不返回Nones"><a href="#14-尽量用异常来表示特殊情况，而不返回Nones" class="headerlink" title="14. 尽量用异常来表示特殊情况，而不返回Nones"></a>14. 尽量用异常来表示特殊情况，而不返回Nones</h2><p>例：令函数返回None，可能会使调用该函数人犯错</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">divide</span>(<span class="params">a, b</span>):</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		<span class="keyword">return</span> a / b</span><br><span class="line">	<span class="keyword">except</span> ZeroDivisionError:</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">x,y = <span class="number">0</span>, <span class="number">5</span></span><br><span class="line">result = divide(x, y)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> result:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;Invaid inputs&#x27;</span>) <span class="comment"># This is WRONG !</span></span><br></pre></td></tr></table></figure>

<p>改进方法一： 把返回值拆两部分，例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">divide</span>(<span class="params">a, b</span>):</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">True</span>, a / b</span><br><span class="line">	<span class="keyword">except</span> ZeroDivisionError:</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">False</span>, <span class="literal">None</span></span><br></pre></td></tr></table></figure>

<p>改进方法二：给上一级抛异常</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">divide</span>(<span class="params">a, b</span>):</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		<span class="keyword">return</span> a / b:</span><br><span class="line">	<span class="keyword">except</span> ZeroDivisionError <span class="keyword">as</span> e:</span><br><span class="line">		<span class="keyword">raise</span> ValueError(<span class="string">&#x27;Invalid inputs&#x27;</span>) <span class="keyword">from</span> e</span><br></pre></td></tr></table></figure>

<h2 id="15-了解如何在闭包里使用外围作用域中的变量"><a href="#15-了解如何在闭包里使用外围作用域中的变量" class="headerlink" title="15. 了解如何在闭包里使用外围作用域中的变量"></a>15. 了解如何在闭包里使用外围作用域中的变量</h2><p>使用nonlocal获取闭包内的数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sort_priority3</span>(<span class="params">numbers, group</span>):</span><br><span class="line">	found = <span class="literal">False</span></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">helper</span>(<span class="params">x</span>):</span><br><span class="line">		<span class="keyword">nonlocal</span> found</span><br><span class="line">		<span class="keyword">if</span> x <span class="keyword">in</span> group:</span><br><span class="line">			found = <span class="literal">True</span></span><br><span class="line">			<span class="keyword">return</span> (<span class="number">0</span>, x)</span><br><span class="line">		<span class="keyword">return</span> (<span class="number">1</span>, x)</span><br><span class="line">	numbers.sort(key=helper)</span><br><span class="line">	<span class="keyword">return</span> found</span><br></pre></td></tr></table></figure>

<h2 id="16-用生成器改写直接返回列表函数"><a href="#16-用生成器改写直接返回列表函数" class="headerlink" title="16. 用生成器改写直接返回列表函数"></a>16. 用生成器改写直接返回列表函数</h2><p>这种写法的问题是，返回前要把所有结果放在列表里，如果输入量非常大，程序可能耗尽内存崩溃</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">index_words</span>(<span class="params">text</span>):</span><br><span class="line">	result = []</span><br><span class="line">	<span class="keyword">if</span> text:</span><br><span class="line">		result.append(<span class="number">0</span>)</span><br><span class="line">	<span class="keyword">for</span> index, letter <span class="keyword">in</span> <span class="built_in">enumerate</span>(text):</span><br><span class="line">		<span class="keyword">if</span> letter == <span class="string">&#x27; &#x27;</span>:</span><br><span class="line">			result.append(index + <span class="number">1</span>)</span><br><span class="line">	<span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">address = <span class="string">&#x27;Four score and seven years ago...&#x27;</span></span><br><span class="line">result = index_words(address)</span><br><span class="line"><span class="built_in">print</span>(result[:<span class="number">3</span>])</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">[<span class="number">0</span>, <span class="number">5</span>, <span class="number">11</span>]</span><br></pre></td></tr></table></figure>

<p>用生成器改写会更好，生成器用yield表达式函数，调用生成器函数时，不会真的运行，而是返回迭代器</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">index_word_iter</span>(<span class="params">text</span>):</span><br><span class="line">	<span class="keyword">if</span> text:</span><br><span class="line">		<span class="keyword">yield</span> <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> index, letter <span class="keyword">in</span> <span class="built_in">enumerate</span>(text):</span><br><span class="line">		<span class="keyword">if</span> letter == <span class="string">&#x27; &#x27;</span>:</span><br><span class="line">			<span class="keyword">yield</span> index + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">address = <span class="string">&#x27;Four score and seven years ago...&#x27;</span></span><br><span class="line">result = <span class="built_in">list</span>(index_words_iter(address))</span><br><span class="line">[<span class="number">0</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">21</span>, <span class="number">27</span>]</span><br></pre></td></tr></table></figure>

<h2 id="17-在参数上迭代时，多加小心"><a href="#17-在参数上迭代时，多加小心" class="headerlink" title="17. 在参数上迭代时，多加小心"></a>17. 在参数上迭代时，多加小心</h2><p>函数在输入参数上多次迭代时要当心，如果参数是迭代器，可能导致奇怪的行为并错失某些值</p>
<h2 id="18-用数量可变位置参数减少视觉杂讯-visual-noise"><a href="#18-用数量可变位置参数减少视觉杂讯-visual-noise" class="headerlink" title="18. 用数量可变位置参数减少视觉杂讯 (visual noise)"></a>18. 用数量可变位置参数减少视觉杂讯 (visual noise)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">log</span>(<span class="params">message, *values</span>):</span><br><span class="line">	<span class="keyword">if</span> <span class="keyword">not</span> values:</span><br><span class="line">		<span class="built_in">print</span>(message)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		values_str = <span class="string">&#x27;, &#x27;</span>.join(<span class="built_in">str</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> values)</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;%s: %s&#x27;</span> % (message, values_str))</span><br><span class="line"></span><br><span class="line">log(<span class="string">&#x27;My numbers are&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">log(<span class="string">&#x27;Hi there&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>要点：</p>
<ul>
<li>def语句中使用*args, 即可令函数接收数量可变的位置参数</li>
<li>在已经接收*args参数的函数上继续添加位置参数，可能产生难以排查的BUG</li>
</ul>
<h2 id="19-用关键字参数表达可选的行为"><a href="#19-用关键字参数表达可选的行为" class="headerlink" title="19. 用关键字参数表达可选的行为"></a>19. 用关键字参数表达可选的行为</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">remainder</span>(<span class="params">number, divisor</span>):</span><br><span class="line">	<span class="keyword">return</span> number % divisor</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>下面这些调用，都是等效的</span><br><span class="line">remainder(<span class="number">20</span>, <span class="number">7</span>)</span><br><span class="line">remainder(<span class="number">20</span>, divisor=<span class="number">7</span>)</span><br><span class="line">remainder(number=<span class="number">20</span>, divisor=<span class="number">7</span>)</span><br><span class="line">remainder(ivisor=<span class="number">7</span>, number=<span class="number">20</span>)</span><br></pre></td></tr></table></figure>

<p>灵活使用关键字参数，提供如下好处：</p>
<ul>
<li>更容易理解含义</li>
<li>在函数定义中提供默认值，使代码简洁</li>
</ul>
<h2 id="20-用None和文档字符串描述含有动态默认值的参数"><a href="#20-用None和文档字符串描述含有动态默认值的参数" class="headerlink" title="20. 用None和文档字符串描述含有动态默认值的参数"></a>20. 用None和文档字符串描述含有动态默认值的参数</h2><p>参数默认值，只会在程序加载模块并读到本函数的定义时评估一次，对于{}或[]等动态的值，这可能会导致奇怪的行为</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">data, default=&#123;&#125;</span>):</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		<span class="keyword">return</span> json.loads(data)</span><br><span class="line">	<span class="keyword">except</span> ValueError:</span><br><span class="line">		<span class="keyword">return</span> default</span><br><span class="line"></span><br><span class="line">foo = decode(<span class="string">&#x27;bad data&#x27;</span>)</span><br><span class="line">foo[<span class="string">&#x27;stuff&#x27;</span>] = <span class="number">5</span></span><br><span class="line">bar = decode(<span class="string">&#x27;also bad&#x27;</span>)</span><br><span class="line">bar[<span class="string">&#x27;meep&#x27;</span>] = <span class="number">1</span></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">Foo: &#123;<span class="string">&#x27;stuff&#x27;</span>: <span class="number">5</span>, <span class="string">&#x27;meep&#x27;</span>: <span class="number">1</span>&#125;</span><br><span class="line">Bar: &#123;<span class="string">&#x27;stuff&#x27;</span>: <span class="number">5</span>, <span class="string">&#x27;meep&#x27;</span>: <span class="number">1</span>&#125; <span class="comment"># Wrong</span></span><br></pre></td></tr></table></figure>

<p>解决方法是，把关键字参数默认设置为None，并在文档字符串中描述它的行为</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">data, default=<span class="literal">None</span></span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot; Load JSON data from a string</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	Args:</span></span><br><span class="line"><span class="string">		data: JSON data to decode</span></span><br><span class="line"><span class="string">		default: Value to return if decoding fails, Defaults to an empty dictionary</span></span><br><span class="line"><span class="string">	&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> default <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        default = &#123;&#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> json.loads(data)</span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        <span class="keyword">return</span> default</span><br></pre></td></tr></table></figure>

<h2 id="21-用只能以关键字形式指定的参数来确保代码明晰"><a href="#21-用只能以关键字形式指定的参数来确保代码明晰" class="headerlink" title="21. 用只能以关键字形式指定的参数来确保代码明晰"></a>21. 用只能以关键字形式指定的参数来确保代码明晰</h2><h1 id="第3章-类与继承"><a href="#第3章-类与继承" class="headerlink" title="第3章 类与继承"></a>第3章 类与继承</h1><h2 id="22-尽量用辅助类维护程序状态，而不要用字典和元组"><a href="#22-尽量用辅助类维护程序状态，而不要用字典和元组" class="headerlink" title="22. 尽量用辅助类维护程序状态，而不要用字典和元组"></a>22. 尽量用辅助类维护程序状态，而不要用字典和元组</h2><ul>
<li>不要使用包含其他字典的字典，也不要使用过长的元组</li>
<li>如果容器中包含简单而又不可变的数据，可先使用namedtuple表示，后有需要再修改为类</li>
<li>保存内部状态的字典如果比较复杂，应该把代码拆解为辅助类</li>
</ul>
<h2 id="23-简单的接口应该接受函数，而不是类的实例"><a href="#23-简单的接口应该接受函数，而不是类的实例" class="headerlink" title="23. 简单的接口应该接受函数，而不是类的实例"></a>23. 简单的接口应该接受函数，而不是类的实例</h2><p>Python有许多内置API，允许调用者传入函数，以定制其行为，例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>names = [<span class="string">&#x27;Socrates&#x27;</span>, <span class="string">&#x27;Archimedes&#x27;</span>, <span class="string">&#x27;Plato&#x27;</span>, <span class="string">&#x27;Aristotle&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>names.sort(key=<span class="keyword">lambda</span> x: <span class="built_in">len</span>(x))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(names)</span><br><span class="line">[<span class="string">&#x27;Plato&#x27;</span>, <span class="string">&#x27;Socrates&#x27;</span>, <span class="string">&#x27;Aristotle&#x27;</span>, <span class="string">&#x27;Archimedes&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>其他编程语言可能用抽象类定义挂钩，然而在Python中，很多挂钩只是无状态函数，这些函数有明确参数和返回值。用函数做挂钩，比定义一个类要简单</p>
<h2 id="24-以-classmethod形式的多态去通用地构建对象"><a href="#24-以-classmethod形式的多态去通用地构建对象" class="headerlink" title="24. 以@classmethod形式的多态去通用地构建对象"></a>24. 以@classmethod形式的多态去通用地构建对象</h2><p>通过@classmethod机制，可以用一种与构造器相仿的方式构造类的对象</p>
<h2 id="25-用super初始化父类"><a href="#25-用super初始化父类" class="headerlink" title="25. 用super初始化父类"></a>25. 用super初始化父类</h2><ul>
<li>直接调用父类的__init__方法，在多重继承影响下，可能产生无法预知行为</li>
<li>总是应该使用内置的super函数初始化父类</li>
</ul>
<h2 id="26-只在使用Mix-in组件制作工具类时进行多重继承"><a href="#26-只在使用Mix-in组件制作工具类时进行多重继承" class="headerlink" title="26. 只在使用Mix-in组件制作工具类时进行多重继承"></a>26. 只在使用Mix-in组件制作工具类时进行多重继承</h2><h2 id="27-多用public属性，少用private属性"><a href="#27-多用public属性，少用private属性" class="headerlink" title="27. 多用public属性，少用private属性"></a>27. 多用public属性，少用private属性</h2><ul>
<li>Python编译器无法严格保证private字段私密性，用经典的格言来说：“we are all consenting adults here”，大家都认为开放比封闭更好</li>
<li>只有子类不受自己控制时，才可以考虑用private属性来避免名称冲突</li>
</ul>
<h2 id="28-继承collections-abc以实现自定义的容器类型"><a href="#28-继承collections-abc以实现自定义的容器类型" class="headerlink" title="28. 继承collections.abc以实现自定义的容器类型"></a>28. 继承collections.abc以实现自定义的容器类型</h2><p>编写自制容器类型，可以从内置collections.abc模块的抽象基类中继承。从这样的基类继承了子类后，如果忘记实现某个方法，那么collections.abc模块会指出这个错误：</p>
<pre><code>from collections.abc import Sequence
class BadType(Sequence):
    pass
foo = BadType()
&gt;&gt;&gt;
TypeError: Can&#39;t instantiate abstract class BadType with ...
</code></pre>
<h1 id="第4章-元素与属性"><a href="#第4章-元素与属性" class="headerlink" title="第4章 元素与属性"></a>第4章 元素与属性</h1><h2 id="29-用纯属性取代get和set方法"><a href="#29-用纯属性取代get和set方法" class="headerlink" title="29. 用纯属性取代get和set方法"></a>29. 用纯属性取代get和set方法</h2><p>从其他语言转入Python的开发者，可能会在类中明确实现getter, setter，但这种做法不像Python编程风格</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">OldResistor</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, ohms</span>):</span><br><span class="line">        <span class="variable language_">self</span>._ohms = ohms</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_ohms</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>._ohms</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">set_ohms</span>(<span class="params">self, ohms</span>):</span><br><span class="line">        <span class="variable language_">self</span>._ohms = ohms</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">obj = OldResistor(<span class="number">50e3</span>)</span><br><span class="line"><span class="built_in">print</span>(obj.get_ohms())</span><br></pre></td></tr></table></figure>

<p>但是，对Python来说，不需要手工实现setter和getter，而是直接用public属性，这样原地自增操作变得清晰自然</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Resistor</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__init</span>(<span class="params">self, ohms</span>):</span><br><span class="line">		<span class="variable language_">self</span>.ohms = ohms</span><br><span class="line">r1 = Resistor(<span class="number">50e3</span>)</span><br><span class="line">r1.ohms += <span class="number">5e3</span></span><br></pre></td></tr></table></figure>

<h2 id="30-考虑用-property代替属性重构"><a href="#30-考虑用-property代替属性重构" class="headerlink" title="30. 考虑用@property代替属性重构"></a>30. 考虑用@property代替属性重构</h2><p>Python内置的@property装饰器负责把一个方法变成属性调用</p>
<p>例，使用@property既能检查参数，又可以用类似属性这样简单方法访问类的变量</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">score</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.score</span><br><span class="line"></span><br><span class="line"><span class="meta">    @score.setter</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">score</span>(<span class="params">self, value</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(value, <span class="built_in">int</span>):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;score must be an int!&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> value &lt; <span class="number">0</span> <span class="keyword">or</span> value &gt; <span class="number">100</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;score must between 0 ~ 100&#x27;</span>)</span><br><span class="line">        <span class="variable language_">self</span>._score = value</span><br><span class="line"></span><br><span class="line">s = Student()</span><br><span class="line">s.score = <span class="number">60</span></span><br><span class="line">s.score = <span class="number">10000</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>python test.py</span><br><span class="line">ValueError: score must between <span class="number">0</span> ~ <span class="number">100</span></span><br></pre></td></tr></table></figure>

<h2 id="31-用描述符来改写需要复用的-property方法"><a href="#31-用描述符来改写需要复用的-property方法" class="headerlink" title="31. 用描述符来改写需要复用的@property方法"></a>31. 用描述符来改写需要复用的@property方法</h2><h2 id="32-用getattr-getattribute-setattr实现按需生成操作-惰性方式加载并保存对象属性）"><a href="#32-用getattr-getattribute-setattr实现按需生成操作-惰性方式加载并保存对象属性）" class="headerlink" title="32. 用getattr, getattribute, setattr实现按需生成操作 (惰性方式加载并保存对象属性）"></a>32. 用getattr, getattribute, setattr实现按需生成操作 (惰性方式加载并保存对象属性）</h2><ul>
<li>如果某个类定义了__getattr__，同时系统在该类对象实例字典中找不到待查属性，那么，系统就会调用这个方法</li>
<li>程序每次访问对象属性，Python系统会调用__getattribute__</li>
</ul>
<h2 id="33-用元类验证子类"><a href="#33-用元类验证子类" class="headerlink" title="33. 用元类验证子类"></a>33. 用元类验证子类</h2><h2 id="34-用元类注册子类"><a href="#34-用元类注册子类" class="headerlink" title="34. 用元类注册子类"></a>34. 用元类注册子类</h2><h1 id="第5章-并发及并行"><a href="#第5章-并发及并行" class="headerlink" title="第5章 并发及并行"></a>第5章 并发及并行</h1><h2 id="36-用subprocess模块管理子进程"><a href="#36-用subprocess模块管理子进程" class="headerlink" title="36. 用subprocess模块管理子进程"></a>36. 用subprocess模块管理子进程</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">proc = subprocess.Popen([<span class="string">&#x27;echo&#x27;</span>, <span class="string">&#x27;hello&#x27;</span>], stdout=subprocess.PIPE)</span><br><span class="line">out, err = proc.communicate()</span><br><span class="line"><span class="built_in">print</span>(out.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>把子进程从父进程中剥离</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_sleep</span>(<span class="params">period</span>):</span><br><span class="line">    proc = subprocess.Popen([<span class="string">&#x27;sleep&#x27;</span>, <span class="built_in">str</span>(period)])</span><br><span class="line">    <span class="keyword">return</span> proc</span><br><span class="line"></span><br><span class="line">start = time.time()</span><br><span class="line">procs = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    proc = run_sleep(<span class="number">0.1</span>)</span><br><span class="line">    procs.append(proc)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> proc <span class="keyword">in</span> procs:</span><br><span class="line">    proc.communicate()</span><br><span class="line">end = time.time()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Finished in %.3f seconds&#x27;</span> % (end - start))</span><br></pre></td></tr></table></figure>

<h2 id="37-可以用线程执行阻塞式IO，但不要用它做并行计算"><a href="#37-可以用线程执行阻塞式IO，但不要用它做并行计算" class="headerlink" title="37. 可以用线程执行阻塞式IO，但不要用它做并行计算"></a>37. 可以用线程执行阻塞式IO，但不要用它做并行计算</h2><ul>
<li>受到全局解释器锁（GIL）限制，多条Python线程不能在多个CPU核心上平行地执行字节码</li>
</ul>
<h2 id="38-在线程中使用Lock来防止数据竞争"><a href="#38-在线程中使用Lock来防止数据竞争" class="headerlink" title="38. 在线程中使用Lock来防止数据竞争"></a>38. 在线程中使用Lock来防止数据竞争</h2><ul>
<li>GIL不会保护开发者自己代码， 同一时刻固然只能有一个Python线程运行，但这个线程正在操作某个数据结构时，其他线程可能会打断它，也就是说Python解释器来执行两个连续字节码指令时，其他线程可能会中途插进来。</li>
</ul>
<p>threading.Lock类实现了互斥锁</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LockingCounter</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">		<span class="variable language_">self</span>.lock = Lock()</span><br><span class="line">		<span class="variable language_">self</span>.count = <span class="number">0</span></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">increment</span>(<span class="params">self, offset</span>):</span><br><span class="line">		<span class="keyword">with</span> <span class="variable language_">self</span>.lock:</span><br><span class="line">			<span class="variable language_">self</span>.count += offset</span><br></pre></td></tr></table></figure>

<h2 id="39-用Queue协调各线程之间的工作"><a href="#39-用Queue协调各线程之间的工作" class="headerlink" title="39. 用Queue协调各线程之间的工作"></a>39. 用Queue协调各线程之间的工作</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Queue</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">q = Queue.Queue(<span class="number">10</span>=</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">producer</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        q.put(i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">consumer</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        <span class="built_in">print</span>(q.get())</span><br><span class="line"></span><br><span class="line">threads = []</span><br><span class="line"></span><br><span class="line">t1 = threading.Thread(target=consumer)</span><br><span class="line">t2 = threading.Thread(target=producer)</span><br></pre></td></tr></table></figure>

<h2 id="40-考虑用协程并发地运行多个函数"><a href="#40-考虑用协程并发地运行多个函数" class="headerlink" title="40.考虑用协程并发地运行多个函数"></a>40.考虑用协程并发地运行多个函数</h2><ul>
<li>对于生成器的yield表达式来说，外部代码通过send方法传给生成器的那个值，就是该表达式所具备的值</li>
</ul>
<h2 id="x20-41-考虑用concurrent-futures实现平行计算"><a href="#x20-41-考虑用concurrent-futures实现平行计算" class="headerlink" title="&#x20;41. 考虑用concurrent.futures实现平行计算"></a>&#x20;41. 考虑用concurrent.futures实现平行计算</h2><ul>
<li>multiprocessing模块可用于实现平行计算，利用multiprocessing模块最恰当做法，是通过内置concurrent.futures模块及其ProcessPoolExecutor类使用它</li>
</ul>
<h1 id="第6章-内置模块"><a href="#第6章-内置模块" class="headerlink" title="第6章 内置模块"></a>第6章 内置模块</h1><h2 id="x20-42-用functools-wraps定义函数修饰器"><a href="#x20-42-用functools-wraps定义函数修饰器" class="headerlink" title="&#x20;42. 用functools.wraps定义函数修饰器"></a>&#x20;42. 用functools.wraps定义函数修饰器</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">trace</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        result = func(*args, **kwargs)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;%s(%r, %r) -&gt; %r&#x27;</span> % (func.__name__, args, kwargs, result))</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@trace</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fibonacci</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n <span class="keyword">in</span> (<span class="number">0</span>, <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">return</span> n</span><br><span class="line">    <span class="keyword">return</span> fibonacci(n - <span class="number">2</span>) + fibonacci(n - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(fibonacci(<span class="number">3</span>))</span><br></pre></td></tr></table></figure>

<ul>
<li>Python为修饰器提供专门语法，使得程序运行时，能用一个函数修改另一个函数</li>
</ul>
<h2 id="43-考虑以contextlib和with语句改写可复用的try-finally代码"><a href="#43-考虑以contextlib和with语句改写可复用的try-finally代码" class="headerlink" title="43. 考虑以contextlib和with语句改写可复用的try&#x2F;finally代码"></a>43. 考虑以contextlib和with语句改写可复用的try&#x2F;finally代码</h2><p>用with语句代替try… finally，例如</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;/path/to/file&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	f.read()</span><br></pre></td></tr></table></figure>

<h2 id="44-用copyreg实现可靠pickle操作"><a href="#44-用copyreg实现可靠pickle操作" class="headerlink" title="44. 用copyreg实现可靠pickle操作"></a>44. 用copyreg实现可靠pickle操作</h2><p>内置的pickle模块能够将Python对象字节序列转化为字节流，也能把字节反序列化成Python对象</p>
<h2 id="45-使用datatime模块处理本地时间而不是time"><a href="#45-使用datatime模块处理本地时间而不是time" class="headerlink" title="45. 使用datatime模块处理本地时间而不是time"></a>45. 使用datatime模块处理本地时间而不是time</h2><ul>
<li>不要用time模块在不同时区进行转换</li>
<li>开发者总是应该先把时间表示成UTC，然后对其转换，最后再转回本地时间</li>
</ul>
<h2 id="46-使用内置算法和数据结构"><a href="#46-使用内置算法和数据结构" class="headerlink" title="46. 使用内置算法和数据结构"></a>46. 使用内置算法和数据结构</h2><ul>
<li>双向队列 deque</li>
<li>有序字典 OrderedDict (按照键插入顺序，保留键值对在字典中次序）</li>
<li>优先级队列 heapq</li>
<li>二分查找 bisect</li>
<li>迭代器有关 itertools</li>
</ul>
<h2 id="47-重视精确度场合，应该使用decimal"><a href="#47-重视精确度场合，应该使用decimal" class="headerlink" title="47.重视精确度场合，应该使用decimal"></a>47.重视精确度场合，应该使用decimal</h2><p>Decimal类适合用在对精度要求高，对舍入行为要求严格的场合，例如：涉及货币计算的场合</p>
<h2 id="48-学会安装由Python开发者社区构建的模块-x20"><a href="#48-学会安装由Python开发者社区构建的模块-x20" class="headerlink" title="48. 学会安装由Python开发者社区构建的模块&#x20;"></a>48. 学会安装由Python开发者社区构建的模块&#x20;</h2><ul>
<li>PyPI (Python Package Index) 包含许多常用软件包， pip命令行工具可以从PyPI中安装软件包</li>
</ul>
<h1 id="第7章-协作开发"><a href="#第7章-协作开发" class="headerlink" title="第7章 协作开发"></a>第7章 协作开发</h1><h2 id="49-为每个函数、类和模块编写文档字符串"><a href="#49-为每个函数、类和模块编写文档字符串" class="headerlink" title="49. 为每个函数、类和模块编写文档字符串"></a>49. 为每个函数、类和模块编写文档字符串</h2><p><strong>为模块编写文档</strong></p>
<ul>
<li>每个模块应该有顶级的docstring</li>
<li>头一行文字，用一句话描述本模块用途，接着一段话包含一些细节信息，把与本模块操作相关内容，告诉模块使用者。</li>
<li>还可以在模块的dockstring中，强调本模块里比较重要类和函数，使开发者据此了解该模块用法</li>
</ul>
<p>举例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># words.py</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="string">&quot;&quot;&quot; Library for XXX...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Testing how words XXX...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Available functions:</span></span><br><span class="line"><span class="string"> - palindrome: Determine if a word ...</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p><strong>为类编写文档</strong></p>
<p>每一个类应该有docstring，写法与模块级的docstring大致相同，如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Player</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot;Represents a player of the game.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	Subclassses may override ...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	Public attributes:</span></span><br><span class="line"><span class="string">	- power: ...</span></span><br><span class="line"><span class="string">	- coins: ...</span></span><br><span class="line"><span class="string">	&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p><strong>为函数编写文档</strong></p>
<p>函数的docstring，第一行用一句话描述函数功能，接下来用一段话描述具体行为和函数参数。 若函数由返回值，应该在docstring中写明</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">find_anagrams</span>(<span class="params">word, dictionary</span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot;Find all anagrams for a word.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	This function only runs as fast as the test for membership in the dictionary container...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	Args:</span></span><br><span class="line"><span class="string">		word: String of the target word.</span></span><br><span class="line"><span class="string">		dictionary: Container with all strings that are known to be actual words.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	Returns:</span></span><br><span class="line"><span class="string">		List of anagrams that were found. Empty if none were found.</span></span><br></pre></td></tr></table></figure>
<p>作者的建议：</p>
<ul>
<li>如果函数没有参数，仅有一个简单返回值，那么只需一句话描述该函数就够了</li>
<li>如果函数没有返回值，不要在docstring里提及，不要出现return None这种说法</li>
<li>如果正常使用中不会抛异常，就不要在docstring提到异常</li>
<li>如果函数接收可变参数，应该在文档中描述*args, **kwargs用途</li>
<li>如果函数参数有默认值，应该指出这些默认值</li>
</ul>
<h2 id="50-用包安排模块，并提供稳固API"><a href="#50-用包安排模块，并提供稳固API" class="headerlink" title="50. 用包安排模块，并提供稳固API"></a>50. 用包安排模块，并提供稳固API</h2><p>在目录中放入名为__init__.py的空文件，就可以采用相对于该目录的路径，引入目录中其他Python文件，例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">main.py</span><br><span class="line">mypackage/__init__.py</span><br><span class="line">mypackage/utils.py</span><br></pre></td></tr></table></figure>

<p>在main.py中引入utils模块</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># main.py</span></span><br><span class="line"><span class="keyword">from</span> mypackage <span class="keyword">import</span> utils</span><br></pre></td></tr></table></figure>

<p><strong>as子句可以给引入当前作用域的属性重新起名，解决冲突</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> analysis.utils <span class="keyword">import</span> inspect <span class="keyword">as</span> analysis_inspect</span><br><span class="line"><span class="keyword">from</span> frontend.utils <span class="keyword">import</span> inspect <span class="keyword">as</span> frontend_inspect</span><br></pre></td></tr></table></figure>

<p>尽量不要使用import *语句，而是应该用from x import y，明确指出自己想要引入的名称</p>
<h2 id="51-为自编的模块定义根异常，以便将调用者与API隔离"><a href="#51-为自编的模块定义根异常，以便将调用者与API隔离" class="headerlink" title="51. 为自编的模块定义根异常，以便将调用者与API隔离"></a>51. 为自编的模块定义根异常，以便将调用者与API隔离</h2><h2 id="52-用适当方式打破循环依赖关系"><a href="#52-用适当方式打破循环依赖关系" class="headerlink" title="52. 用适当方式打破循环依赖关系"></a>52. 用适当方式打破循环依赖关系</h2><ul>
<li>如果两个模块必须相互调用对方，才能完成引入操作，就会出现循环依赖现象，这可能导致程序启动时崩溃</li>
<li>打破循环依赖关系最佳方案，是把导致两个模块互相依赖的那部分代码，重构为单独模块，并把它放在依赖树底部</li>
</ul>
<h2 id="53-用虚拟环境隔离项目，并重建其依赖关系"><a href="#53-用虚拟环境隔离项目，并重建其依赖关系" class="headerlink" title="53. 用虚拟环境隔离项目，并重建其依赖关系"></a>53. 用虚拟环境隔离项目，并重建其依赖关系</h2><h1 id="x20-第8章-部署"><a href="#x20-第8章-部署" class="headerlink" title="&#x20;第8章 部署"></a>&#x20;第8章 部署</h1><h2 id="54-考虑用模块级别代码配置不同部署环境-x20"><a href="#54-考虑用模块级别代码配置不同部署环境-x20" class="headerlink" title="54. 考虑用模块级别代码配置不同部署环境&#x20;"></a>54. 考虑用模块级别代码配置不同部署环境&#x20;</h2><h2 id="55-通过repr字符串输出调试信息"><a href="#55-通过repr字符串输出调试信息" class="headerlink" title="55. 通过repr字符串输出调试信息"></a>55. 通过repr字符串输出调试信息</h2><p>简单的print不能打印出值的类型信息，可以用repr获取类型信息</p>
<h2 id="56-用unittest测试全部代码"><a href="#56-用unittest测试全部代码" class="headerlink" title="56. 用unittest测试全部代码"></a>56. 用unittest测试全部代码</h2><h2 id="57-用pdb实现交互调试"><a href="#57-用pdb实现交互调试" class="headerlink" title="57. 用pdb实现交互调试"></a>57. 用pdb实现交互调试</h2><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://docs.python.org/zh-cn/3/library/pdb.html">https://docs.python.org/zh-cn/3/library/pdb.html</a></p>
<h2 id="58-先分析性能，然后再优化"><a href="#58-先分析性能，然后再优化" class="headerlink" title="58. 先分析性能，然后再优化"></a>58. 先分析性能，然后再优化</h2><h2 id="59-用tracemalloc掌握内存使用和泄漏情况"><a href="#59-用tracemalloc掌握内存使用和泄漏情况" class="headerlink" title="59. 用tracemalloc掌握内存使用和泄漏情况"></a>59. 用tracemalloc掌握内存使用和泄漏情况</h2>
    </div>

    
    
    
        <div class="reward-container">
  <div></div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.jpg" alt="PC 微信支付">
        <p>微信支付</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.jpg" alt="PC 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>PC
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://pcj600.github.io/2023/0812215151.html" title="Effective Python 笔记">https://pcj600.github.io/2023/0812215151.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>所有文章都欢迎转载, 注明出处即可.
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Python/" rel="tag"><i class="fa fa-tag"></i> Python</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2023/0719214818.html" rel="prev" title="流畅的Python 笔记">
      <i class="fa fa-chevron-left"></i> 流畅的Python 笔记
    </a></div>
      <div class="post-nav-item">
    <a href="/2023/0815215310.html" rel="next" title="Python的Lamdba函数是什么，应用场景是什么?">
      Python的Lamdba函数是什么，应用场景是什么? <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC1%E7%AB%A0%EF%BC%9A%E7%94%A8Pythonic%E6%96%B9%E5%BC%8F%E6%9D%A5%E6%80%9D%E8%80%83"><span class="nav-text">第1章：用Pythonic方式来思考</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#x20-1-%E7%94%A8Pythonic%E6%96%B9%E5%BC%8F%E6%9D%A5%E6%80%9D%E8%80%83"><span class="nav-text"> 1. 用Pythonic方式来思考</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#x20-2-%E9%81%B5%E5%BE%AAPEP8%E9%A3%8E%E6%A0%BC"><span class="nav-text"> 2. 遵循PEP8风格</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E4%BA%86%E8%A7%A3bytes-str-unicode%E5%8C%BA%E5%88%AB"><span class="nav-text">3. 了解bytes, str, unicode区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E7%94%A8%E8%BE%85%E5%8A%A9%E5%87%BD%E6%95%B0%E5%8F%96%E4%BB%A3%E5%A4%8D%E6%9D%82%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-text">4. 用辅助函数取代复杂表达式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E4%BA%86%E8%A7%A3%E5%88%87%E5%89%B2%E5%BA%8F%E5%88%97%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-text">5. 了解切割序列的方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-%E5%8D%95%E6%AC%A1%E5%88%87%E7%89%87%E6%93%8D%E4%BD%9C%E5%86%85%EF%BC%8C%E4%B8%8D%E8%A6%81%E5%90%8C%E6%97%B6%E6%8C%87%E5%AE%9Astart-end-stride"><span class="nav-text">6. 单次切片操作内，不要同时指定start, end, stride</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#x20-7-%E7%94%A8%E5%88%97%E8%A1%A8%E6%8E%A8%E5%AF%BC%E5%8F%96%E4%BB%A3map-filter"><span class="nav-text"> 7. 用列表推导取代map, filter</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-%E4%B8%8D%E8%A6%81%E4%BD%BF%E7%94%A8%E5%90%AB%E6%9C%89%E4%B8%A4%E4%B8%AA%E4%BB%A5%E4%B8%8A%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E5%88%97%E8%A1%A8%E6%8E%A8%E5%AF%BC"><span class="nav-text">8. 不要使用含有两个以上表达式的列表推导</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-%E7%94%A8%E7%94%9F%E6%88%90%E5%99%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%94%B9%E5%86%99%E6%95%B0%E6%8D%AE%E9%87%8F%E8%BE%83%E5%A4%A7%E7%9A%84%E5%88%97%E8%A1%A8%E6%8E%A8%E5%AF%BC"><span class="nav-text">9. 用生成器表达式改写数据量较大的列表推导</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-%E5%B0%BD%E9%87%8F%E7%94%A8enumerate%E5%8F%96%E4%BB%A3range"><span class="nav-text">10. 尽量用enumerate取代range</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11-%E7%94%A8zip%E5%87%BD%E6%95%B0%E5%90%8C%E6%97%B6%E9%81%8D%E5%8E%86%E4%B8%A4%E4%B8%AA%E8%BF%AD%E4%BB%A3%E5%99%A8"><span class="nav-text">11. 用zip函数同时遍历两个迭代器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#12-%E4%B8%8D%E8%A6%81%E5%9C%A8for%E5%92%8Cwhile%E5%BE%AA%E7%8E%AF%E5%90%8E%E5%86%99else%E5%9D%97"><span class="nav-text">12. 不要在for和while循环后写else块</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#13-%E5%90%88%E7%90%86%E5%88%A9%E7%94%A8try-except-else-finally%E7%BB%93%E6%9E%84%E4%B8%AD%E6%AF%8F%E4%B8%AA%E4%BB%A3%E7%A0%81%E5%9D%97"><span class="nav-text">13. 合理利用try&#x2F;except&#x2F;else&#x2F;finally结构中每个代码块</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC2%E7%AB%A0-%E5%87%BD%E6%95%B0"><span class="nav-text">第2章 函数</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#14-%E5%B0%BD%E9%87%8F%E7%94%A8%E5%BC%82%E5%B8%B8%E6%9D%A5%E8%A1%A8%E7%A4%BA%E7%89%B9%E6%AE%8A%E6%83%85%E5%86%B5%EF%BC%8C%E8%80%8C%E4%B8%8D%E8%BF%94%E5%9B%9ENones"><span class="nav-text">14. 尽量用异常来表示特殊情况，而不返回Nones</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#15-%E4%BA%86%E8%A7%A3%E5%A6%82%E4%BD%95%E5%9C%A8%E9%97%AD%E5%8C%85%E9%87%8C%E4%BD%BF%E7%94%A8%E5%A4%96%E5%9B%B4%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B8%AD%E7%9A%84%E5%8F%98%E9%87%8F"><span class="nav-text">15. 了解如何在闭包里使用外围作用域中的变量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#16-%E7%94%A8%E7%94%9F%E6%88%90%E5%99%A8%E6%94%B9%E5%86%99%E7%9B%B4%E6%8E%A5%E8%BF%94%E5%9B%9E%E5%88%97%E8%A1%A8%E5%87%BD%E6%95%B0"><span class="nav-text">16. 用生成器改写直接返回列表函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#17-%E5%9C%A8%E5%8F%82%E6%95%B0%E4%B8%8A%E8%BF%AD%E4%BB%A3%E6%97%B6%EF%BC%8C%E5%A4%9A%E5%8A%A0%E5%B0%8F%E5%BF%83"><span class="nav-text">17. 在参数上迭代时，多加小心</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#18-%E7%94%A8%E6%95%B0%E9%87%8F%E5%8F%AF%E5%8F%98%E4%BD%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%87%8F%E5%B0%91%E8%A7%86%E8%A7%89%E6%9D%82%E8%AE%AF-visual-noise"><span class="nav-text">18. 用数量可变位置参数减少视觉杂讯 (visual noise)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#19-%E7%94%A8%E5%85%B3%E9%94%AE%E5%AD%97%E5%8F%82%E6%95%B0%E8%A1%A8%E8%BE%BE%E5%8F%AF%E9%80%89%E7%9A%84%E8%A1%8C%E4%B8%BA"><span class="nav-text">19. 用关键字参数表达可选的行为</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#20-%E7%94%A8None%E5%92%8C%E6%96%87%E6%A1%A3%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8F%8F%E8%BF%B0%E5%90%AB%E6%9C%89%E5%8A%A8%E6%80%81%E9%BB%98%E8%AE%A4%E5%80%BC%E7%9A%84%E5%8F%82%E6%95%B0"><span class="nav-text">20. 用None和文档字符串描述含有动态默认值的参数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#21-%E7%94%A8%E5%8F%AA%E8%83%BD%E4%BB%A5%E5%85%B3%E9%94%AE%E5%AD%97%E5%BD%A2%E5%BC%8F%E6%8C%87%E5%AE%9A%E7%9A%84%E5%8F%82%E6%95%B0%E6%9D%A5%E7%A1%AE%E4%BF%9D%E4%BB%A3%E7%A0%81%E6%98%8E%E6%99%B0"><span class="nav-text">21. 用只能以关键字形式指定的参数来确保代码明晰</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC3%E7%AB%A0-%E7%B1%BB%E4%B8%8E%E7%BB%A7%E6%89%BF"><span class="nav-text">第3章 类与继承</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#22-%E5%B0%BD%E9%87%8F%E7%94%A8%E8%BE%85%E5%8A%A9%E7%B1%BB%E7%BB%B4%E6%8A%A4%E7%A8%8B%E5%BA%8F%E7%8A%B6%E6%80%81%EF%BC%8C%E8%80%8C%E4%B8%8D%E8%A6%81%E7%94%A8%E5%AD%97%E5%85%B8%E5%92%8C%E5%85%83%E7%BB%84"><span class="nav-text">22. 尽量用辅助类维护程序状态，而不要用字典和元组</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#23-%E7%AE%80%E5%8D%95%E7%9A%84%E6%8E%A5%E5%8F%A3%E5%BA%94%E8%AF%A5%E6%8E%A5%E5%8F%97%E5%87%BD%E6%95%B0%EF%BC%8C%E8%80%8C%E4%B8%8D%E6%98%AF%E7%B1%BB%E7%9A%84%E5%AE%9E%E4%BE%8B"><span class="nav-text">23. 简单的接口应该接受函数，而不是类的实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#24-%E4%BB%A5-classmethod%E5%BD%A2%E5%BC%8F%E7%9A%84%E5%A4%9A%E6%80%81%E5%8E%BB%E9%80%9A%E7%94%A8%E5%9C%B0%E6%9E%84%E5%BB%BA%E5%AF%B9%E8%B1%A1"><span class="nav-text">24. 以@classmethod形式的多态去通用地构建对象</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#25-%E7%94%A8super%E5%88%9D%E5%A7%8B%E5%8C%96%E7%88%B6%E7%B1%BB"><span class="nav-text">25. 用super初始化父类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#26-%E5%8F%AA%E5%9C%A8%E4%BD%BF%E7%94%A8Mix-in%E7%BB%84%E4%BB%B6%E5%88%B6%E4%BD%9C%E5%B7%A5%E5%85%B7%E7%B1%BB%E6%97%B6%E8%BF%9B%E8%A1%8C%E5%A4%9A%E9%87%8D%E7%BB%A7%E6%89%BF"><span class="nav-text">26. 只在使用Mix-in组件制作工具类时进行多重继承</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#27-%E5%A4%9A%E7%94%A8public%E5%B1%9E%E6%80%A7%EF%BC%8C%E5%B0%91%E7%94%A8private%E5%B1%9E%E6%80%A7"><span class="nav-text">27. 多用public属性，少用private属性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#28-%E7%BB%A7%E6%89%BFcollections-abc%E4%BB%A5%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E5%AE%B9%E5%99%A8%E7%B1%BB%E5%9E%8B"><span class="nav-text">28. 继承collections.abc以实现自定义的容器类型</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC4%E7%AB%A0-%E5%85%83%E7%B4%A0%E4%B8%8E%E5%B1%9E%E6%80%A7"><span class="nav-text">第4章 元素与属性</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#29-%E7%94%A8%E7%BA%AF%E5%B1%9E%E6%80%A7%E5%8F%96%E4%BB%A3get%E5%92%8Cset%E6%96%B9%E6%B3%95"><span class="nav-text">29. 用纯属性取代get和set方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#30-%E8%80%83%E8%99%91%E7%94%A8-property%E4%BB%A3%E6%9B%BF%E5%B1%9E%E6%80%A7%E9%87%8D%E6%9E%84"><span class="nav-text">30. 考虑用@property代替属性重构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#31-%E7%94%A8%E6%8F%8F%E8%BF%B0%E7%AC%A6%E6%9D%A5%E6%94%B9%E5%86%99%E9%9C%80%E8%A6%81%E5%A4%8D%E7%94%A8%E7%9A%84-property%E6%96%B9%E6%B3%95"><span class="nav-text">31. 用描述符来改写需要复用的@property方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#32-%E7%94%A8getattr-getattribute-setattr%E5%AE%9E%E7%8E%B0%E6%8C%89%E9%9C%80%E7%94%9F%E6%88%90%E6%93%8D%E4%BD%9C-%E6%83%B0%E6%80%A7%E6%96%B9%E5%BC%8F%E5%8A%A0%E8%BD%BD%E5%B9%B6%E4%BF%9D%E5%AD%98%E5%AF%B9%E8%B1%A1%E5%B1%9E%E6%80%A7%EF%BC%89"><span class="nav-text">32. 用getattr, getattribute, setattr实现按需生成操作 (惰性方式加载并保存对象属性）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#33-%E7%94%A8%E5%85%83%E7%B1%BB%E9%AA%8C%E8%AF%81%E5%AD%90%E7%B1%BB"><span class="nav-text">33. 用元类验证子类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#34-%E7%94%A8%E5%85%83%E7%B1%BB%E6%B3%A8%E5%86%8C%E5%AD%90%E7%B1%BB"><span class="nav-text">34. 用元类注册子类</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC5%E7%AB%A0-%E5%B9%B6%E5%8F%91%E5%8F%8A%E5%B9%B6%E8%A1%8C"><span class="nav-text">第5章 并发及并行</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#36-%E7%94%A8subprocess%E6%A8%A1%E5%9D%97%E7%AE%A1%E7%90%86%E5%AD%90%E8%BF%9B%E7%A8%8B"><span class="nav-text">36. 用subprocess模块管理子进程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#37-%E5%8F%AF%E4%BB%A5%E7%94%A8%E7%BA%BF%E7%A8%8B%E6%89%A7%E8%A1%8C%E9%98%BB%E5%A1%9E%E5%BC%8FIO%EF%BC%8C%E4%BD%86%E4%B8%8D%E8%A6%81%E7%94%A8%E5%AE%83%E5%81%9A%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97"><span class="nav-text">37. 可以用线程执行阻塞式IO，但不要用它做并行计算</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#38-%E5%9C%A8%E7%BA%BF%E7%A8%8B%E4%B8%AD%E4%BD%BF%E7%94%A8Lock%E6%9D%A5%E9%98%B2%E6%AD%A2%E6%95%B0%E6%8D%AE%E7%AB%9E%E4%BA%89"><span class="nav-text">38. 在线程中使用Lock来防止数据竞争</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#39-%E7%94%A8Queue%E5%8D%8F%E8%B0%83%E5%90%84%E7%BA%BF%E7%A8%8B%E4%B9%8B%E9%97%B4%E7%9A%84%E5%B7%A5%E4%BD%9C"><span class="nav-text">39. 用Queue协调各线程之间的工作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#40-%E8%80%83%E8%99%91%E7%94%A8%E5%8D%8F%E7%A8%8B%E5%B9%B6%E5%8F%91%E5%9C%B0%E8%BF%90%E8%A1%8C%E5%A4%9A%E4%B8%AA%E5%87%BD%E6%95%B0"><span class="nav-text">40.考虑用协程并发地运行多个函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#x20-41-%E8%80%83%E8%99%91%E7%94%A8concurrent-futures%E5%AE%9E%E7%8E%B0%E5%B9%B3%E8%A1%8C%E8%AE%A1%E7%AE%97"><span class="nav-text"> 41. 考虑用concurrent.futures实现平行计算</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC6%E7%AB%A0-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97"><span class="nav-text">第6章 内置模块</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#x20-42-%E7%94%A8functools-wraps%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0%E4%BF%AE%E9%A5%B0%E5%99%A8"><span class="nav-text"> 42. 用functools.wraps定义函数修饰器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#43-%E8%80%83%E8%99%91%E4%BB%A5contextlib%E5%92%8Cwith%E8%AF%AD%E5%8F%A5%E6%94%B9%E5%86%99%E5%8F%AF%E5%A4%8D%E7%94%A8%E7%9A%84try-finally%E4%BB%A3%E7%A0%81"><span class="nav-text">43. 考虑以contextlib和with语句改写可复用的try&#x2F;finally代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#44-%E7%94%A8copyreg%E5%AE%9E%E7%8E%B0%E5%8F%AF%E9%9D%A0pickle%E6%93%8D%E4%BD%9C"><span class="nav-text">44. 用copyreg实现可靠pickle操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#45-%E4%BD%BF%E7%94%A8datatime%E6%A8%A1%E5%9D%97%E5%A4%84%E7%90%86%E6%9C%AC%E5%9C%B0%E6%97%B6%E9%97%B4%E8%80%8C%E4%B8%8D%E6%98%AFtime"><span class="nav-text">45. 使用datatime模块处理本地时间而不是time</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#46-%E4%BD%BF%E7%94%A8%E5%86%85%E7%BD%AE%E7%AE%97%E6%B3%95%E5%92%8C%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="nav-text">46. 使用内置算法和数据结构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#47-%E9%87%8D%E8%A7%86%E7%B2%BE%E7%A1%AE%E5%BA%A6%E5%9C%BA%E5%90%88%EF%BC%8C%E5%BA%94%E8%AF%A5%E4%BD%BF%E7%94%A8decimal"><span class="nav-text">47.重视精确度场合，应该使用decimal</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#48-%E5%AD%A6%E4%BC%9A%E5%AE%89%E8%A3%85%E7%94%B1Python%E5%BC%80%E5%8F%91%E8%80%85%E7%A4%BE%E5%8C%BA%E6%9E%84%E5%BB%BA%E7%9A%84%E6%A8%A1%E5%9D%97-x20"><span class="nav-text">48. 学会安装由Python开发者社区构建的模块 </span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC7%E7%AB%A0-%E5%8D%8F%E4%BD%9C%E5%BC%80%E5%8F%91"><span class="nav-text">第7章 协作开发</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#49-%E4%B8%BA%E6%AF%8F%E4%B8%AA%E5%87%BD%E6%95%B0%E3%80%81%E7%B1%BB%E5%92%8C%E6%A8%A1%E5%9D%97%E7%BC%96%E5%86%99%E6%96%87%E6%A1%A3%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-text">49. 为每个函数、类和模块编写文档字符串</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#50-%E7%94%A8%E5%8C%85%E5%AE%89%E6%8E%92%E6%A8%A1%E5%9D%97%EF%BC%8C%E5%B9%B6%E6%8F%90%E4%BE%9B%E7%A8%B3%E5%9B%BAAPI"><span class="nav-text">50. 用包安排模块，并提供稳固API</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#51-%E4%B8%BA%E8%87%AA%E7%BC%96%E7%9A%84%E6%A8%A1%E5%9D%97%E5%AE%9A%E4%B9%89%E6%A0%B9%E5%BC%82%E5%B8%B8%EF%BC%8C%E4%BB%A5%E4%BE%BF%E5%B0%86%E8%B0%83%E7%94%A8%E8%80%85%E4%B8%8EAPI%E9%9A%94%E7%A6%BB"><span class="nav-text">51. 为自编的模块定义根异常，以便将调用者与API隔离</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#52-%E7%94%A8%E9%80%82%E5%BD%93%E6%96%B9%E5%BC%8F%E6%89%93%E7%A0%B4%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB"><span class="nav-text">52. 用适当方式打破循环依赖关系</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#53-%E7%94%A8%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83%E9%9A%94%E7%A6%BB%E9%A1%B9%E7%9B%AE%EF%BC%8C%E5%B9%B6%E9%87%8D%E5%BB%BA%E5%85%B6%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB"><span class="nav-text">53. 用虚拟环境隔离项目，并重建其依赖关系</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#x20-%E7%AC%AC8%E7%AB%A0-%E9%83%A8%E7%BD%B2"><span class="nav-text"> 第8章 部署</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#54-%E8%80%83%E8%99%91%E7%94%A8%E6%A8%A1%E5%9D%97%E7%BA%A7%E5%88%AB%E4%BB%A3%E7%A0%81%E9%85%8D%E7%BD%AE%E4%B8%8D%E5%90%8C%E9%83%A8%E7%BD%B2%E7%8E%AF%E5%A2%83-x20"><span class="nav-text">54. 考虑用模块级别代码配置不同部署环境 </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#55-%E9%80%9A%E8%BF%87repr%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BE%93%E5%87%BA%E8%B0%83%E8%AF%95%E4%BF%A1%E6%81%AF"><span class="nav-text">55. 通过repr字符串输出调试信息</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#56-%E7%94%A8unittest%E6%B5%8B%E8%AF%95%E5%85%A8%E9%83%A8%E4%BB%A3%E7%A0%81"><span class="nav-text">56. 用unittest测试全部代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#57-%E7%94%A8pdb%E5%AE%9E%E7%8E%B0%E4%BA%A4%E4%BA%92%E8%B0%83%E8%AF%95"><span class="nav-text">57. 用pdb实现交互调试</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#58-%E5%85%88%E5%88%86%E6%9E%90%E6%80%A7%E8%83%BD%EF%BC%8C%E7%84%B6%E5%90%8E%E5%86%8D%E4%BC%98%E5%8C%96"><span class="nav-text">58. 先分析性能，然后再优化</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#59-%E7%94%A8tracemalloc%E6%8E%8C%E6%8F%A1%E5%86%85%E5%AD%98%E4%BD%BF%E7%94%A8%E5%92%8C%E6%B3%84%E6%BC%8F%E6%83%85%E5%86%B5"><span class="nav-text">59. 用tracemalloc掌握内存使用和泄漏情况</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="PC"
      src="/images/avatar.jpg">
  <!-- <p class="site-author-name" itemprop="name">PC</p> -->
  <div class="site-description" itemprop="description">PC的博客</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">139</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">32</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">41</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="/nju_pc@163.com" title="E-Mail → nju_pc@163.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        



<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">PC</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">460k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">6:58</span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener external nofollow noreferrer" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener external nofollow noreferrer" target="_blank">NexT.Pisces</a> 强力驱动
  </div>
-->

        
  <script async src="/js/busuanzi.js"></script>









      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right"},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.2}});</script></body>
</html>

<script type="text/javascript" src="/js/clicklove.js"></script>
